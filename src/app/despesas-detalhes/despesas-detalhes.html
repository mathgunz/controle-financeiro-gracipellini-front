<div class="container">
  <header class="topo">
    <button class="btn-acao btn-voltar" routerLink="/despesas" aria-label="Voltar para despesas">â†</button>

    <div class="titulo-wrapper">
      <p class="subtitulo">VisualizaÃ§Ã£o</p>
      <h1>Detalhes da despesa</h1>
    </div>

    <div class="acoes" *ngIf="!carregando && despesa">
      <button class="btn-acao" type="button" (click)="toggleEdicao()" [attr.aria-label]="modoEdicao ? 'Travar edicao' : 'Destravar edicao'">
        {{ modoEdicao ? 'ğŸ”’' : 'ğŸ”“' }}
      </button>
    </div>
  </header>

  <section *ngIf="carregando" class="estado-card">
    <p>Carregando detalhes...</p>
  </section>

  <section *ngIf="!carregando && erro" class="estado-card erro">
    <p>{{ erro }}</p>
  </section>

  <section *ngIf="!carregando && mensagem" class="estado-card sucesso">
    <p>{{ mensagem }}</p>
  </section>

  <section *ngIf="!carregando && despesa" class="detalhes-card">
    <div class="linha">
      <span>Id</span>
      <strong>{{ despesa.id }}</strong>
    </div>
    <div class="linha">
      <span>Nome</span>
      <input *ngIf="modoEdicao && despesaEdicao" [(ngModel)]="despesaEdicao.nome" type="text" />
      <strong *ngIf="!modoEdicao">{{ despesa.nome }}</strong>
    </div>
    <div class="linha">
      <span>Valor</span>
      <input *ngIf="modoEdicao && despesaEdicao" [(ngModel)]="despesaEdicao.valor" type="number" min="0" step="0.01" />
      <strong *ngIf="!modoEdicao">{{ +despesa.valor | currency:'BRL' }}</strong>
    </div>
    <div class="linha">
      <span>Data de pagamento</span>
      <input *ngIf="modoEdicao && despesaEdicao" [(ngModel)]="despesaEdicao.dataPagamento" type="text" />
      <strong *ngIf="!modoEdicao">{{ despesa.dataPagamento }}</strong>
    </div>
    <div class="linha">
      <span>Tipo de pagamento</span>
      <input *ngIf="modoEdicao && despesaEdicao" [(ngModel)]="despesaEdicao.tipoPagamento" type="text" />
      <strong *ngIf="!modoEdicao">{{ despesa.tipoPagamento }}</strong>
    </div>
    <div class="linha">
      <span>Categoria</span>
      <input *ngIf="modoEdicao && despesaEdicao" [(ngModel)]="despesaEdicao.categoria" type="text" />
      <strong *ngIf="!modoEdicao">{{ despesa.categoria }}</strong>
    </div>
    <div class="linha">
      <span>Conta paga</span>
      <input *ngIf="modoEdicao && despesaEdicao" [(ngModel)]="despesaEdicao.hasContaPaga" type="checkbox" />
      <strong *ngIf="!modoEdicao">{{ despesa.hasContaPaga ? 'Sim' : 'NÃ£o' }}</strong>
    </div>
    <div class="linha">
      <span>Quantidade</span>
      <input *ngIf="modoEdicao && despesaEdicao" [(ngModel)]="despesaEdicao.quantidade" type="number" min="1" />
      <strong *ngIf="!modoEdicao">{{ despesa.quantidade }}</strong>
    </div>
    <div class="linha">
      <span>RepetiÃ§Ã£o</span>
      <input *ngIf="modoEdicao && despesaEdicao" [(ngModel)]="despesaEdicao.repeticao" type="text" />
      <strong *ngIf="!modoEdicao">{{ despesa.repeticao }}</strong>
    </div>
    <div class="linha">
      <span>Data de criaÃ§Ã£o</span>
      <strong>{{ despesa.dataCriacao }}</strong>
    </div>
    <div class="linha">
      <span>NÃºmero da parcela</span>
      <input *ngIf="modoEdicao && despesaEdicao" [(ngModel)]="despesaEdicao.numeroParcela" type="number" min="1" />
      <strong *ngIf="!modoEdicao">{{ despesa.numeroParcela ?? '-' }}</strong>
    </div>

    <div class="acoes-form" *ngIf="modoEdicao">
      <button class="btn-salvar" type="button" (click)="salvarEdicao()" [disabled]="salvando">
        {{ salvando ? 'Salvando...' : 'Salvar' }}
      </button>
    </div>
  </section>
</div>
