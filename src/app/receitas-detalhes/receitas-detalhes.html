<div class="container">
  <header class="topo">
    <button class="btn-acao btn-voltar" routerLink="/receitas" aria-label="Voltar para receitas">‚Üê</button>

    <div class="titulo-wrapper">
      <p class="subtitulo">Visualizacao</p>
      <h1>Detalhes da receita</h1>
    </div>

    <div class="acoes" *ngIf="!carregando && receita">
      <button class="btn-acao" type="button" (click)="toggleEdicao()" [attr.aria-label]="modoEdicao ? 'Travar edicao' : 'Destravar edicao'">
        {{ modoEdicao ? 'üîí' : 'üîì' }}
      </button>
    </div>
  </header>

  <section *ngIf="carregando" class="estado-card">
    <p>Carregando detalhes...</p>
  </section>

  <section *ngIf="!carregando && erro" class="estado-card erro">
    <p>{{ erro }}</p>
  </section>

  <section *ngIf="!carregando && mensagem" class="estado-card sucesso">
    <p>{{ mensagem }}</p>
  </section>

  <section *ngIf="!carregando && receita" class="detalhes-card">
    <div class="linha">
      <span>Id</span>
      <strong>{{ receita.id }}</strong>
    </div>
    <div class="linha">
      <span>Nome</span>
      <input *ngIf="modoEdicao && receitaEdicao" [(ngModel)]="receitaEdicao.nome" type="text" />
      <strong *ngIf="!modoEdicao">{{ receita.nome }}</strong>
    </div>
    <div class="linha">
      <span>Valor</span>
      <input *ngIf="modoEdicao && receitaEdicao" [(ngModel)]="receitaEdicao.valor" type="number" min="0" step="0.01" />
      <strong *ngIf="!modoEdicao">{{ +receita.valor | currency:'BRL' }}</strong>
    </div>
    <div class="linha">
      <span>Data de recebimento</span>
      <input *ngIf="modoEdicao && receitaEdicao" [(ngModel)]="receitaEdicao.dataRecebimento" type="text" />
      <strong *ngIf="!modoEdicao">{{ receita.dataRecebimento }}</strong>
    </div>
    <div class="linha">
      <span>Recebida</span>
      <input *ngIf="modoEdicao && receitaEdicao" [(ngModel)]="receitaEdicao.hasRecebida" type="checkbox" />
      <strong *ngIf="!modoEdicao">{{ receita.hasRecebida ? 'Sim' : 'Nao' }}</strong>
    </div>
    <div class="linha">
      <span>Quantidade</span>
      <strong>{{ receita.quantidade }}</strong>
    </div>
    <div class="linha">
      <span>Repeticao</span>
      <strong>{{ receita.repeticao }}</strong>
    </div>
    <div class="linha">
      <span>Data de criacao</span>
      <strong>{{ receita.dataCriacao }}</strong>
    </div>

    <div class="acoes-form" *ngIf="modoEdicao">
      <button class="btn-salvar" type="button" (click)="salvarEdicao()" [disabled]="salvando">
        {{ salvando ? 'Salvando...' : 'Salvar' }}
      </button>
    </div>
  </section>

  <div class="modal-overlay" *ngIf="mostrarModalTipoEdicao">
    <section class="modal-card">
      <header class="modal-topo">
        <button class="btn-acao btn-voltar-modal" type="button" (click)="fecharModalTipoEdicao()" aria-label="Voltar">
          ‚Üê
        </button>
        <h2>Tipo de edicao</h2>
      </header>

      <p>Escolha como deseja aplicar esta alteracao:</p>

      <button
        class="btn-opcao"
        type="button"
        *ngFor="let tipo of tiposEdicao"
        (click)="confirmarTipoEdicao(tipo.valor)"
        [disabled]="salvando">
        {{ tipo.label }}
      </button>
    </section>
  </div>
</div>
